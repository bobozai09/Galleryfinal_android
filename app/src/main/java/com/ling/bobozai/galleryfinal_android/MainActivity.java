package com.ling.bobozai.galleryfinal_android;import android.Manifest;import android.app.Activity;import android.content.pm.PackageManager;import android.os.Bundle;import android.support.annotation.NonNull;import android.view.View;import android.widget.Button;import android.widget.ImageView;import android.widget.Toast;import com.bumptech.glide.Glide;import com.ling.bobozai.galleryfinal_android.widget.DialogUtil;import com.ling.bobozai.galleryfinal_android.widget.SelectPicDialog;import java.util.List;import butterknife.BindView;import butterknife.ButterKnife;import cn.finalteam.galleryfinal.GalleryFinal;import cn.finalteam.galleryfinal.model.PhotoInfo;import cn.finalteam.toolsfinal.BitmapUtils;import static com.ling.bobozai.galleryfinal_android.widget.PermissUtils.PERMISSION_CODE_VIDEO;public class MainActivity extends Activity {    Button btnTakePhoto;    PhotoInfo photoInfo;    ImageView imageView;SelectPicDialog selectPicDialog;    @Override    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.activity_main);        ButterKnife.bind(this);        btnTakePhoto=findViewById(R.id.btn_takePhoto);        imageView=findViewById(R.id.image_show);        btnTakePhoto.setOnClickListener(onClickListener);    }    private View.OnClickListener onClickListener=new View.OnClickListener() {        @Override        public void onClick(View view) {            switch (view.getId()){                case R.id.btn_takePhoto:                    selectPicDialog= (SelectPicDialog) DialogUtil.showSelectPicDialog(MainActivity.this,6,onHanlderResultCallback);                    break;            }        }    };    GalleryFinal.OnHanlderResultCallback onHanlderResultCallback=new GalleryFinal.OnHanlderResultCallback() {        @Override        public void onHanlderSuccess(int reqeustCode, List<PhotoInfo> resultList) {            if (resultList!=null&&resultList.size()>0){                photoInfo=resultList.get(0);                if (com.ling.bobozai.galleryfinal_android.unitls.BitmapUtils.isInvalidPic(photoInfo.getPhotoPath())){                    Toast.makeText(getApplicationContext(),"无效图片",Toast.LENGTH_LONG).show();                    return;                }                String path=photoInfo.getPhotoPath();                Glide.with(getApplicationContext()).load(path).into(imageView);            }        }        @Override        public void onHanlderFailure(int requestCode, String errorMsg) {        }    };    @Override    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {       switch (requestCode) {           case PERMISSION_CODE_VIDEO:               if (grantResults.length > 0 && grantResults[0] == PackageManager.PERMISSION_GRANTED) {                   for (int i = 0; i < permissions.length; i++) {                       if (Manifest.permission.CAMERA.equals(permissions[i])) {                           selectPicDialog.goTakePicture();                       }                   }               }               break;       }        super.onRequestPermissionsResult(requestCode, permissions, grantResults);    }}